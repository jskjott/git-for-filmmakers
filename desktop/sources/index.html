<!DOCTYPE html>
  <head>
    <meta charset='UTF-8'>
	<script src="scripts/parser.js"></script>
	<script src="scripts/renderer.js"></script>
	<script src="scripts/helperfunctions.js"></script>
	<script src="scripts/git.js"></script>

	<link href="style.css" rel="stylesheet" type="text/css">
	<title>Git for Filmmakers</title>
</head>

<body>
	<div id="graph"></div>
	<div id="timeline"></div>

	<script>
		const Vue = require('vue');

		const vue = new Vue({
		data: {
		    diffXML: null,
		    timelineData: null,
		    timeline: null
		},
		methods: {
		    parse: (data) => { 
		    	return parser(data)
		    },
		    render: (data, diffXML) => {
		    	initRender(data)
		    },
		},
		created: async function() {
		    this.diffXML = await diff({dir:'../example_repo', filepath:'example.fcpxml', branch:'master'})
		},
		watch: {
		    diffXML: function() {
		      	this.timelineData = this.parse(this.diffXML)
		      	this.diffXML.forEach((timeline, i) => {
		      		this.timelineData[i].push(...parseDiff([timeline]))	
		      	})
		      	this.render(this.timelineData, this.diffXML)
		    }
		  }
		});
	</script>	
</body>

