<!DOCTYPE html>
  <head>
    <meta charset='UTF-8'>
	<script src="scripts/parser.js"></script>
	<script src="scripts/renderer.js"></script>
	<script src="scripts/helperfunctions.js"></script>
	<script src="scripts/git.js"></script>

	<link href="style.css" rel="stylesheet" type="text/css">
	<title>Git for Filmmakers</title>
</head>

<body>
	<div id="graph"></div>
	<div id="timeline"></div>

	<script>
		const Vue = require('vue');

		const vue = new Vue({
		data: {
		    diffXML: null,
		    branchFile: null,
		    timelineData: null,
		    timeline: null,
		    scale: null,
		},
		methods: {
		    parse: (data) => { 
		    	return parser(data)
		    },
		    render: (data, scale, branchFile, timeline) => {
		    	const timelineHeights = initRender(data, scale)
		    	renderTree(branchFile, timelineHeights)
		    },
		},
		created: async function() {
		    [this.diffXML, this.branchFile] = await diff({dir:'../example_repo', filepath:'example.fcpxml', branch:'master'})
		},
		watch: {
		    diffXML: function() {
		      	this.timelineData = this.parse(this.diffXML)
		      	this.diffXML.forEach((timeline, i) => {
		      		this.timelineData[i].push(...parseDiff([timeline]))	
		      	})

		      	this.scale = new Scale(this.timelineData)
		      	this.render(this.timelineData, this.scale, this.branchFile, this.timelineData)
		    }
		  }
		});
	</script>	
</body>

